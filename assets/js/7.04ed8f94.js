(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{274:function(t,s,a){t.exports=a.p+"assets/img/2022080910120811.9bbff0d8.png"},292:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"mysql-主从搭建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql-主从搭建"}},[t._v("#")]),t._v(" MYSQL 主从搭建")]),t._v(" "),n("h2",{attrs:{id:"一、背景"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、背景"}},[t._v("#")]),t._v(" 一、背景")]),t._v(" "),n("blockquote",[n("p",[t._v("因为在项目开发需求，本地无法直接连接服务器MYSQL主从，考虑在开发测试时，可以测试方便发现基本问题。考虑在本地虚拟机中搭建，模拟测试环境及线上环境，故选用虚拟机的docker来搭建。选择搭建一主两从")])]),t._v(" "),n("h2",{attrs:{id:"二、mysql主从模式简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、mysql主从模式简介"}},[t._v("#")]),t._v(" 二、MYSQL主从模式简介")]),t._v(" "),n("p",[n("strong",[t._v("读写分离，顾名思义就是读和写分开，更具体来说，就是：")])]),t._v(" "),n("ul",[n("li",[t._v("写操作在主数据库进行")]),t._v(" "),n("li",[t._v("读操作在从数据库进行")])]),t._v(" "),n("p",[t._v("使用读写分离的根本目的就是为了提高并发性能，如果读写都在同一台"),n("code",[t._v("MySQL")]),t._v("上实现，相信会不如一台"),n("code",[t._v("MySQL")]),t._v("写，另外两台"),n("code",[t._v("MySQL")]),t._v("读这样的配置性能高。另一方面，在很多时候都是读操作的请求要远远高于写操作，这样就显得读写分离非常有必要了。")]),t._v(" "),n("p",[n("strong",[t._v("主从复制，顾名思义就是把主库的数据复制到从库中")]),t._v("，因为读写分离之后，写操作都在主库进行，但是读操作是在从库进行的，也就是说，主库上的数据如果不能复制到从库中，那么从库就不会读到主库中的数据。严格意义上说，读写分离并不要求主从复制，只需要在主库写从库读即可，但是如果没有了主从复制，读写分离将失去了它的意义。因此读写分离通常与主从复制配合使用。")]),t._v(" "),n("p",[t._v("因为本示例使用的是"),n("code",[t._v("MySQL")]),t._v("，这里就说一下"),n("code",[t._v("MySQL")]),t._v("主从复制的原理，如下图所示：\n"),n("img",{attrs:{src:a(274),alt:"img"}})]),t._v(" "),n("p",[n("strong",[t._v("工作流程如下：")])]),t._v(" "),n("ul",[n("li",[t._v("主库修改数据后，将修改日志写入"),n("code",[t._v("binlog")])]),t._v(" "),n("li",[t._v("从库的"),n("code",[t._v("I/O")]),t._v("线程读取主库的"),n("code",[t._v("binlog")]),t._v("，并拷贝到从库本地的"),n("code",[t._v("binlog")]),t._v("中")]),t._v(" "),n("li",[t._v("从库本地的"),n("code",[t._v("binlog")]),t._v("被"),n("code",[t._v("SQL")]),t._v("线程读取，执行其中的内容并同步到从库中")])]),t._v(" "),n("h2",{attrs:{id:"三、环境搭建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、环境搭建"}},[t._v("#")]),t._v(" 三、环境搭建")]),t._v(" "),n("h3",{attrs:{id:"_1、前置环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、前置环境"}},[t._v("#")]),t._v(" 1、前置环境")]),t._v(" "),n("p",[t._v("基础环境安装：")]),t._v(" "),n("ul",[n("li",[t._v("docker")]),t._v(" "),n("li",[t._v("docker-compose")]),t._v(" "),n("li",[t._v("mysql镜像版本：mysql:5.7")])]),t._v(" "),n("h3",{attrs:{id:"_2、创建以下目录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、创建以下目录"}},[t._v("#")]),t._v(" 2、创建以下目录：")]),t._v(" "),n("ul",[n("li",[t._v("mysql\n"),n("ul",[n("li",[t._v("docker-compose.yml")]),t._v(" "),n("li",[t._v("config\n"),n("ul",[n("li",[t._v("master.cnf")]),t._v(" "),n("li",[t._v("slave1.cnf")]),t._v(" "),n("li",[t._v("slave2.cnf")])])])])])]),t._v(" "),n("h3",{attrs:{id:"_3、配置内容"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、配置内容"}},[t._v("#")]),t._v(" 3、配置内容")]),t._v(" "),n("h4",{attrs:{id:"docker-compose-yml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-yml"}},[t._v("#")]),t._v(" docker-compose.yml")]),t._v(" "),n("div",{staticClass:"language-yml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-yml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3.6'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mysql-master")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.7")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("master\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("privileged")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("TZ")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Asia/Shanghai\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("default"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("authentication"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("plugin=mysql_native_password\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("character"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("set"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server=utf8mb4\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("collation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server=utf8mb4_general_ci\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("explicit_defaults_for_timestamp=true\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("lower_case_table_names=1\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("max_allowed_packet=128M;\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 3316"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./config/master.cnf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etc/mysql/my.cnf\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mysql-slave1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.7")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("slave1\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("privileged")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("TZ")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Asia/Shanghai\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("default"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("authentication"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("plugin=mysql_native_password\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("character"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("set"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server=utf8mb4\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("collation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server=utf8mb4_general_ci\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("explicit_defaults_for_timestamp=true\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("lower_case_table_names=1\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("max_allowed_packet=128M;\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 3317"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./config/slave1.cnf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etc/mysql/my.cnf\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mysql-slave2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.7")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("slave2\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("privileged")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("TZ")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Asia/Shanghai\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("default"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("authentication"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("plugin=mysql_native_password\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("character"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("set"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server=utf8mb4\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("collation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server=utf8mb4_general_ci\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("explicit_defaults_for_timestamp=true\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("lower_case_table_names=1\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("max_allowed_packet=128M;\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 3318"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./config/slave2.cnf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etc/mysql/my.cnf\n\n")])])]),n("h4",{attrs:{id:"master-cnf"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#master-cnf"}},[t._v("#")]),t._v(" master.cnf")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mysqld"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\npid-file\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /var/run/mysqld/mysqld.pid\nsocket\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /var/run/mysqld/mysqld.sock\ndatadir\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /var/lib/mysql\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#log-error\t= /var/log/mysql/error.log")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# By default we only accept connections from localhost")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#bind-address\t= 127.0.0.1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Disabling symbolic-links is recommended to prevent assorted security risks")]),t._v("\nsymbolic-links"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\nport        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#全局唯一，取值[1,2^32-1]，默认为1")]),t._v("\nserver-id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\nlog-bin "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" master-bin \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#只保留7天的二进制日志，以防磁盘被日志占满(可选)")]),t._v("\nexpire-logs-days "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#不备份的数据库 （可选）")]),t._v("\nbinlog-ignore-db"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("information_schema  \nbinlog-ignore-db"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("performation_schema\nbinlog-ignore-db"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("sys\n\n")])])]),n("h4",{attrs:{id:"slave1-cnf"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#slave1-cnf"}},[t._v("#")]),t._v(" slave1.cnf")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mysqld"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\npid-file\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /var/run/mysqld/mysqld.pid\nsocket\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /var/run/mysqld/mysqld.sock\ndatadir\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /var/lib/mysql\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#log-error\t= /var/log/mysql/error.log")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# By default we only accept connections from localhost")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#bind-address\t= 127.0.0.1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Disabling symbolic-links is recommended to prevent assorted security risks")]),t._v("\nsymbolic-links"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\nport        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#全局唯一，取值[1,2^32-1]，默认为1")]),t._v("\nserver-id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#只保留7天的二进制日志，以防磁盘被日志占满(可选)")]),t._v("\nexpire-logs-days "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#不备份的数据库 （可选）")]),t._v("\nbinlog-ignore-db"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("information_schema  \nbinlog-ignore-db"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("performation_schema\nbinlog-ignore-db"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("sys\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 开启二进制日志功能，以备Slave作为其它Slave的Master时使用")]),t._v("\nlog-bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("slave1-bin   \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## relay_log配置中继日志")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("relay_log")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("mysql-relay-bin  \n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("read_only")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 设置为只读,该项如果不设置，表示slave可读可写")]),t._v("\n")])])]),n("h4",{attrs:{id:"slave2-cnf"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#slave2-cnf"}},[t._v("#")]),t._v(" slave2.cnf")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mysqld"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\npid-file\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /var/run/mysqld/mysqld.pid\nsocket\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /var/run/mysqld/mysqld.sock\ndatadir\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /var/lib/mysql\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#log-error\t= /var/log/mysql/error.log")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# By default we only accept connections from localhost")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#bind-address\t= 127.0.0.1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Disabling symbolic-links is recommended to prevent assorted security risks")]),t._v("\nsymbolic-links"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\nport        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#全局唯一，取值[1,2^32-1]，默认为1")]),t._v("\nserver-id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#只保留7天的二进制日志，以防磁盘被日志占满(可选)")]),t._v("\nexpire-logs-days "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#不备份的数据库 （可选）")]),t._v("\nbinlog-ignore-db"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("information_schema  \nbinlog-ignore-db"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("performation_schema\nbinlog-ignore-db"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("sys\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 开启二进制日志功能，以备Slave作为其它Slave的Master时使用")]),t._v("\nlog-bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("slave2-bin   \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## relay_log配置中继日志")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("relay_log")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("mysql-relay-bin  \n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("read_only")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 设置为只读,该项如果不设置，表示slave可读可写")]),t._v("\n")])])]),n("h3",{attrs:{id:"_4、启动docker容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4、启动docker容器"}},[t._v("#")]),t._v(" 4、启动docker容器")]),t._v(" "),n("p",[t._v("进入mysql目录，执行启动命令启动docker容器")]),t._v(" "),n("ul",[n("li",[t._v("启动："),n("code",[t._v("docker-compose up -d")])]),t._v(" "),n("li",[t._v("查看："),n("code",[t._v("docker-compose ps")])]),t._v(" "),n("li",[t._v("停止："),n("code",[t._v("docker-compose down")])])]),t._v(" "),n("h3",{attrs:{id:"_5、设置主从"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5、设置主从"}},[t._v("#")]),t._v(" 5、设置主从")]),t._v(" "),n("p",[t._v("1、进行master容器，连接mysql")]),t._v(" "),n("ol",[n("li",[n("code",[t._v("docker exec -it mysql-master bash")])]),t._v(" "),n("li",[n("code",[t._v("muysql -r root -p 123456")])])]),t._v(" "),n("p",[t._v("2、查看master status\n"),n("code",[t._v("show master status")])]),t._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("+-------------------+----------+--------------+--------------------------------------------+-------------------+\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" File              "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Position "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Binlog_Do_DB "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Binlog_Ignore_DB                           "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Executed_Gtid_Set "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+-------------------+----------+--------------+--------------------------------------------+-------------------+\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" master-bin.000003 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("643")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("              "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" information_schema,performation_schema,sys "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("                   "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+-------------------+----------+--------------+--------------------------------------------+-------------------+\n")])])]),n("p",[t._v("记录下file和position的值")]),t._v(" "),n("p",[t._v("3、分别进行slave1和slave2容器并连接mysql")]),t._v(" "),n("p",[t._v("4、然后执行1)：")]),t._v(" "),n("div",{staticClass:"language-sql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[t._v("change master "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" \nmaster_host"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'192.168.232.130'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--master的IP")]),t._v("\nmaster_user"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--连接master的用户名")]),t._v("\nmaster_log_file"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'master-bin.000003'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--第2步骤查询到的结果file字段的值")]),t._v("\nmaster_log_pos"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("154")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--第2步骤查询到的结果position字段的值")]),t._v("\nmaster_port"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3316")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--master的端口")]),t._v("\nmaster_password"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'123456'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--连接master的密码")]),t._v("\n")])])]),n("p",[t._v("执行2 ：开启从节点"),n("code",[t._v("start slave")]),t._v(";")]),t._v(" "),n("p",[t._v("执行3：显示从节点信息"),n("code",[t._v("show slave status")]),t._v(";")]),t._v(" "),n("h3",{attrs:{id:"_6、查看数据同步"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6、查看数据同步"}},[t._v("#")]),t._v(" 6、查看数据同步")]),t._v(" "),n("p",[t._v("在主节点master上添加数据库、表以及数据看从节点是否同步。")]),t._v(" "),n("h2",{attrs:{id:"四、springboot-mysql主从"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#四、springboot-mysql主从"}},[t._v("#")]),t._v(" 四、SpringBoot+MYSQL主从")]),t._v(" "),n("blockquote",[n("p",[t._v("搭建MYSQL主从只是为了使用，重点是在于怎么做读写分离。")]),t._v(" "),n("p",[t._v("在网上也看到了很多种做读写分离的方案，综合考虑，这里我选择了"),n("code",[t._v("shardingsphere")]),t._v("来做读写分离。")])]),t._v(" "),n("h3",{attrs:{id:"环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#环境"}},[t._v("#")]),t._v(" 环境")]),t._v(" "),n("ol",[n("li",[t._v("jdk1.8")]),t._v(" "),n("li",[t._v("springboot：2.7.5")]),t._v(" "),n("li",[t._v("Mybatis plus：3.5.1")]),t._v(" "),n("li",[t._v("shardingsphere-jdbc：5.1.1")]),t._v(" "),n("li",[t._v("druid：1.1.22")]),t._v(" "),n("li",[t._v("maven：3.6.1")])]),t._v(" "),n("h3",{attrs:{id:"新建springboot项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#新建springboot项目"}},[t._v("#")]),t._v(" 新建springboot项目")]),t._v(" "),n("p",[t._v("​\tMaven版本：")]),t._v(" "),n("div",{staticClass:"language-xml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[t._v("\t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.baomidou"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("mybatis-plus-boot-starter"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("3.5.1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.apache.shardingsphere"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("shardingsphere-jdbc-core-spring-boot-starter"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("5.1.1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.alibaba"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("druid"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.1.22"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("h3",{attrs:{id:"使用mybatisx插件生成代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用mybatisx插件生成代码"}},[t._v("#")]),t._v(" 使用MybatisX插件生成代码")]),t._v(" "),n("p",[t._v("步骤参考："),n("a",{attrs:{href:"https://baomidou.com/pages/ba5b24/#%E5%8A%9F%E8%83%BD",target:"_blank",rel:"noopener noreferrer"}},[t._v("MybatisX插件使用方式"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"配置参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置参考"}},[t._v("#")]),t._v(" 配置参考")]),t._v(" "),n("div",{staticClass:"language-yml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-yml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8084")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spring")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("shardingsphere")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("datasource")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("names")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" master"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("slave1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("slave2\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("master")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jdbc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//192.168.232.130"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3316/test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),t._v("serverTimezone=UTC"),n("span",{pre:!0,attrs:{class:"token important"}},[t._v("&useSSL=false&useUnicode=true&characterEncoding=UTF-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" com.alibaba.druid.pool.DruidDataSource\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("driver-class-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" com.mysql.cj.jdbc.Driver\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" root\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("slave1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jdbc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//192.168.232.130"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3317/test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),t._v("serverTimezone=UTC"),n("span",{pre:!0,attrs:{class:"token important"}},[t._v("&useSSL=false&useUnicode=true&characterEncoding=UTF-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" com.alibaba.druid.pool.DruidDataSource\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("driver-class-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" com.mysql.cj.jdbc.Driver\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" root\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("slave2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jdbc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//192.168.232.130"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3318/test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),t._v("serverTimezone=UTC"),n("span",{pre:!0,attrs:{class:"token important"}},[t._v("&useSSL=false&useUnicode=true&characterEncoding=UTF-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" com.alibaba.druid.pool.DruidDataSource\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("driver-class-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" com.mysql.cj.jdbc.Driver\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" root\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rules")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("sharding")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("readwrite-splitting")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("load-balancers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("round_robin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ROUND_ROBIN\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("data-sources")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("read_write_db")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Static\n            "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("props")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("write-data-source-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" master\n              "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("read-data-source-names")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" slave1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("slave2\n            "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("load-balancer-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" round_robin\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("props")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("sql-show")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n\n")])])]),n("h3",{attrs:{id:"准备测代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#准备测代码"}},[t._v("#")]),t._v(" 准备测代码：")]),t._v(" "),n("p",[t._v("MysqlInit.java")]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 项目初始化执行\n */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Slf4j")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MysqlInit")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Autowired")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OperationService")]),t._v(" operationService"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@PostConstruct")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            operationService"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                operationService"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("query")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("OperationService.java")]),t._v(" "),n("div",{staticClass:"language-java extra-class"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 数据库操作\n */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Slf4j")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Service")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OperationService")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Autowired")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserService")]),t._v(" userService"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Random")]),t._v(" random "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Random")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 生成随机内容添加数据\n     * @param i\n     */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Async")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysqlThreadPool"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" sex"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"男"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            sex"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"女"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" user "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("UUID")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("randomUUID")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("random"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextInt")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("120")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" save "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" userService"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"插入数据成功：{}"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"插入数据失败"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Async")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysqlThreadPool"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("query")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" user "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" userService"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("random"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextInt")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"随机查询数据为：{}"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),n("h3",{attrs:{id:"启动项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动项目"}},[t._v("#")]),t._v(" 启动项目")]),t._v(" "),n("p",[t._v("控制台显示日志：")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.082  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ShardingSphere-SQL                       "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" SQLStatement: MySQLInsertStatement"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("setAssignment"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Optional.empty, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("onDuplicateKeyColumns")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Optional.empty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.082  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ShardingSphere-SQL                       "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Actual SQL: master ::: INSERT INTO user  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" name,sex,age "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  VALUES  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" ?,?,? "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ::: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("489d32c0-8689-4e05-b68e-96b046ae5046, 女, "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.084  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" c.mengl.mysql.service.OperationService   "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" 插入数据成功：User "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Hash "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1085628063")]),t._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7396")]),t._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("489d32c0-8689-4e05-b68e-96b046ae5046, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sex")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("女, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("age")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("serialVersionUID")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.085  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ShardingSphere-SQL                       "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Logic SQL: SELECT id,name,sex,age FROM user WHERE "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("? \n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.085  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ShardingSphere-SQL                       "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" SQLStatement: MySQLSelectStatement"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("table"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Optional.empty, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("limit")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Optional.empty, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("lock")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Optional.empty, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("window")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Optional.empty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.085  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ShardingSphere-SQL                       "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Actual SQL: slave2 ::: SELECT id,name,sex,age FROM user WHERE "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("?  ::: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5072")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.086  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" c.mengl.mysql.service.OperationService   "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" 随机查询数据为：User "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Hash "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1109246400")]),t._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5072")]),t._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("b740fae3-0aae-4542-822d-8dd6c6d274ef, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sex")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("女, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("age")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("serialVersionUID")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.086  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ShardingSphere-SQL                       "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Logic SQL: INSERT INTO user  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" name,sex,age "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  VALUES  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" ?,?,? "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.086  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ShardingSphere-SQL                       "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" SQLStatement: MySQLInsertStatement"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("setAssignment"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Optional.empty, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("onDuplicateKeyColumns")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Optional.empty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.086  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ShardingSphere-SQL                       "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Actual SQL: master ::: INSERT INTO user  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" name,sex,age "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  VALUES  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" ?,?,? "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ::: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("52bebb40-10c9-4117-b2fa-ccaf6104c759, 男, "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("73")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.089  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" c.mengl.mysql.service.OperationService   "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" 插入数据成功：User "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Hash "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" -74377815, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7397")]),t._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("52bebb40-10c9-4117-b2fa-ccaf6104c759, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sex")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("男, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("age")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("73")]),t._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("serialVersionUID")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.089  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ShardingSphere-SQL                       "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Logic SQL: SELECT id,name,sex,age FROM user WHERE "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("? \n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.089  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ShardingSphere-SQL                       "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" SQLStatement: MySQLSelectStatement"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("table"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Optional.empty, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("limit")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Optional.empty, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("lock")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Optional.empty, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("window")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Optional.empty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.089  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ShardingSphere-SQL                       "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Actual SQL: slave1 ::: SELECT id,name,sex,age FROM user WHERE "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("?  ::: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2592")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-11-08 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":26:22.091  INFO "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("28064")]),t._v(" --- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  restartedMain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" c.mengl.mysql.service.OperationService   "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" 随机查询数据为：User "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Hash "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1138329258")]),t._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2592")]),t._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("8998491e-b737-475b-888f-39dd3b0ae65a, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("sex")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("女, "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("age")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("55")]),t._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("serialVersionUID")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n")])])]),n("p",[t._v("可以清晰的看到插入数据使用的是master节点，查询数据使用的是slave1、slave2节点切换。")]),t._v(" "),n("p",[t._v("至此，完成。")])])}),[],!1,null,null,null);s.default=e.exports}}]);